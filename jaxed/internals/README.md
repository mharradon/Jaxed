Updated from original implementation - viewable here: https://github.com/google/jax/commit/902fc0c3d2b3ec9b6034c66074984386ec35606f
